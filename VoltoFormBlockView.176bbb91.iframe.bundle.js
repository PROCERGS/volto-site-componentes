"use strict";(self.webpackChunk_plone_volto=self.webpackChunk_plone_volto||[]).push([[4776],{"./src/components/manage/Widgets/SelectUtils.js":function(__unused_webpack_module,__webpack_exports__,__webpack_require__){__webpack_require__.d(__webpack_exports__,{Cc:function(){return normalizeChoices},Qy:function(){return normalizeValue},eQ:function(){return convertValueToVocabQuery}});var lodash_isBoolean__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("../../../node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/isBoolean.js"),lodash_isBoolean__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(lodash_isBoolean__WEBPACK_IMPORTED_MODULE_0__),lodash_isObject__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("../../../node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/isObject.js"),lodash_isObject__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(lodash_isObject__WEBPACK_IMPORTED_MODULE_1__),lodash_isString__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("../../../node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/isString.js"),lodash_isString__WEBPACK_IMPORTED_MODULE_2___default=__webpack_require__.n(lodash_isString__WEBPACK_IMPORTED_MODULE_2__),_plone_volto_helpers_Vocabularies_Vocabularies__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./src/helpers/Vocabularies/Vocabularies.js");const messages=(0,__webpack_require__("../../../node_modules/.pnpm/react-intl@3.12.1_react@18.2.0/node_modules/react-intl/lib/index.js").defineMessages)({no_value:{id:"No value",defaultMessage:"No value"}});function convertValueToVocabQuery(value){var _value$value;if(lodash_isString__WEBPACK_IMPORTED_MODULE_2___default()(value)||lodash_isBoolean__WEBPACK_IMPORTED_MODULE_0___default()(value))return{token:value.toString()};if(!value)return{};if(Array.isArray(value))return{tokens:value.map((v=>{var _v$value;return lodash_isObject__WEBPACK_IMPORTED_MODULE_1___default()(v)?null!==(_v$value=v.value)&&void 0!==_v$value?_v$value:v.token:lodash_isString__WEBPACK_IMPORTED_MODULE_2___default()(v)||lodash_isBoolean__WEBPACK_IMPORTED_MODULE_0___default()(v)?v:null})).filter((f=>null!==f))};const token=null!==(_value$value=value.value)&&void 0!==_value$value?_value$value:value.token;return lodash_isString__WEBPACK_IMPORTED_MODULE_2___default()(token)?{token:token}:{}}function normalizeSingleSelectOption(value,intl){var _ref,_ref2,_value$token,_ref3,_ref4,_ref5;if(!value)return value;if(Array.isArray(value)){if(2===value.length)return{value:value[0],label:value[1]||value[0]};throw new Error(`Unknown value type of select widget: ${value}`)}return{value:null!==(_ref=null!==(_ref2=null!==(_value$token=value.token)&&void 0!==_value$token?_value$token:value.value)&&void 0!==_ref2?_ref2:value.UID)&&void 0!==_ref?_ref:"no-value",label:null!==(_ref3=null!==(_ref4=null!==(_ref5=value.title&&"None"!==value.title?value.title:void 0)&&void 0!==_ref5?_ref5:value.label)&&void 0!==_ref4?_ref4:value.token)&&void 0!==_ref3?_ref3:intl.formatMessage(messages.no_value)}}const normalizeChoices=(items,intl)=>items.map((item=>normalizeSingleSelectOption(item,intl)));function normalizeValue(choices,value,intl){choices=normalizeChoices(choices||[],intl);const choiceMap=Object.assign({},...choices.map((({label:label,value:value})=>({[value]:label}))));if(!lodash_isObject__WEBPACK_IMPORTED_MODULE_1___default()(value)&&lodash_isBoolean__WEBPACK_IMPORTED_MODULE_0___default()(value)){const label=choiceMap[(0,_plone_volto_helpers_Vocabularies_Vocabularies__WEBPACK_IMPORTED_MODULE_4__.QT)(value)];return label?{label:label,value:value}:{}}return"no-value"===value?{label:intl.formatMessage(messages.no_value),value:"no-value"}:void 0!==value&&value&&0!==value.length?Array.isArray(value)?value.map((v=>normalizeValue(choices,v,intl))):lodash_isObject__WEBPACK_IMPORTED_MODULE_1___default()(value)?normalizeSingleSelectOption(value,intl):Object.keys(choiceMap).includes(value)?{label:choiceMap[value],value:value}:{label:value,value:value}:null}},"./src/components/manage/Widgets/TextWidget.jsx":function(__unused_webpack_module,__webpack_exports__,__webpack_require__){__webpack_require__.r(__webpack_exports__);var _home_runner_work_volto_site_componentes_volto_site_componentes_node_modules_pnpm_babel_runtime_7_26_10_node_modules_babel_runtime_helpers_esm_extends_js__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("../../../node_modules/.pnpm/@babel+runtime@7.26.10/node_modules/@babel/runtime/helpers/esm/extends.js"),react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("../../../node_modules/.pnpm/react@18.2.0/node_modules/react/index.js"),semantic_ui_react__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("../../../node_modules/.pnpm/semantic-ui-react@2.1.5_react-dom@18.2.0_react@18.2.0__react@18.2.0/node_modules/semantic-ui-react/dist/es/elements/Input/Input.js"),_plone_volto_components_theme_Icon_Icon__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./src/components/theme/Icon/Icon.jsx"),_plone_volto_components_manage_Widgets_FormFieldWrapper__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./src/components/manage/Widgets/FormFieldWrapper.jsx"),__jsx=react__WEBPACK_IMPORTED_MODULE_0__.createElement;const TextWidget=props=>{const{id:id,value:value,onChange:onChange,onBlur:onBlur,onClick:onClick,icon:icon,iconAction:iconAction,minLength:minLength,maxLength:maxLength,placeholder:placeholder,isDisabled:isDisabled,focus:focus}=props,ref=(0,react__WEBPACK_IMPORTED_MODULE_0__.useRef)();return(0,react__WEBPACK_IMPORTED_MODULE_0__.useEffect)((()=>{focus&&ref.current.focus()}),[]),__jsx(_plone_volto_components_manage_Widgets_FormFieldWrapper__WEBPACK_IMPORTED_MODULE_2__.default,(0,_home_runner_work_volto_site_componentes_volto_site_componentes_node_modules_pnpm_babel_runtime_7_26_10_node_modules_babel_runtime_helpers_esm_extends_js__WEBPACK_IMPORTED_MODULE_3__.c)({},props,{className:"text"}),__jsx(semantic_ui_react__WEBPACK_IMPORTED_MODULE_4__.c,{id:`field-${id}`,name:id,value:value||"",disabled:isDisabled,icon:icon||null,placeholder:placeholder,onChange:({target:target})=>onChange(id,""===target.value?void 0:target.value),ref:ref,onBlur:({target:target})=>onBlur(id,""===target.value?void 0:target.value),onClick:()=>onClick(),minLength:minLength||null,maxLength:maxLength||null}),icon&&iconAction&&__jsx("button",{className:`field-${id}-action-button`,onClick:iconAction},__jsx(_plone_volto_components_theme_Icon_Icon__WEBPACK_IMPORTED_MODULE_1__.c,{name:icon,size:"18px"})))};__webpack_exports__.default=TextWidget,TextWidget.defaultProps={description:null,required:!1,error:[],value:null,onChange:()=>{},onBlur:()=>{},onClick:()=>{},onEdit:null,onDelete:null,focus:!1,icon:null,iconAction:null,minLength:null,maxLength:null},TextWidget.__docgenInfo={description:"",methods:[],displayName:"TextWidget",props:{description:{defaultValue:{value:"null",computed:!1},description:"",type:{name:"string"},required:!1},required:{defaultValue:{value:"false",computed:!1},description:"",type:{name:"bool"},required:!1},error:{defaultValue:{value:"[]",computed:!1},description:"",type:{name:"arrayOf",value:{name:"string"}},required:!1},value:{defaultValue:{value:"null",computed:!1},description:"",type:{name:"string"},required:!1},onChange:{defaultValue:{value:"() => {}",computed:!1},description:"",type:{name:"func"},required:!1},onBlur:{defaultValue:{value:"() => {}",computed:!1},description:"",type:{name:"func"},required:!1},onClick:{defaultValue:{value:"() => {}",computed:!1},description:"",type:{name:"func"},required:!1},onEdit:{defaultValue:{value:"null",computed:!1},description:"",type:{name:"func"},required:!1},onDelete:{defaultValue:{value:"null",computed:!1},description:"",type:{name:"func"},required:!1},focus:{defaultValue:{value:"false",computed:!1},description:"",type:{name:"bool"},required:!1},icon:{defaultValue:{value:"null",computed:!1},description:"",type:{name:"shape",value:{xmlns:{name:"string",required:!1},viewBox:{name:"string",required:!1},content:{name:"string",required:!1}}},required:!1},iconAction:{defaultValue:{value:"null",computed:!1},description:"",type:{name:"func"},required:!1},minLength:{defaultValue:{value:"null",computed:!1},description:"",type:{name:"number"},required:!1},maxLength:{defaultValue:{value:"null",computed:!1},description:"",type:{name:"number"},required:!1},id:{description:"",type:{name:"string"},required:!0},title:{description:"",type:{name:"string"},required:!0},wrapped:{description:"",type:{name:"bool"},required:!1},placeholder:{description:"",type:{name:"string"},required:!1}}}},"./src/components/manage/Widgets/WysiwygWidget.jsx":function(__unused_webpack_module,__webpack_exports__,__webpack_require__){__webpack_require__.r(__webpack_exports__);var _plone_volto_slate_widgets_HtmlSlateWidget__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("../volto-slate/src/widgets/HtmlSlateWidget.jsx");__webpack_exports__.default=_plone_volto_slate_widgets_HtmlSlateWidget__WEBPACK_IMPORTED_MODULE_0__.c},"../../../packages/volto-site-componentes/src/customizations/volto-form-block/components/View.jsx":function(__unused_webpack_module,__webpack_exports__,__webpack_require__){__webpack_require__.r(__webpack_exports__);var _home_runner_work_volto_site_componentes_volto_site_componentes_node_modules_pnpm_babel_runtime_7_26_10_node_modules_babel_runtime_helpers_esm_objectSpread2_js__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__("../../../node_modules/.pnpm/@babel+runtime@7.26.10/node_modules/@babel/runtime/helpers/esm/objectSpread2.js"),react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("../../../node_modules/.pnpm/react@18.2.0/node_modules/react/index.js"),react_redux__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("../../../node_modules/.pnpm/react-redux@8.1.2_@types+react-dom@18.3.7_@types+react@18.3.23__@types+react@18.3.23_react-do_obuanppmdhunhdkx73zfrljf4m/node_modules/react-redux/es/index.js"),react_intl__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__("../../../node_modules/.pnpm/react-intl@3.12.1_react@18.2.0/node_modules/react-intl/lib/index.js"),react_intl__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__("../../../node_modules/.pnpm/react-intl@3.12.1_react@18.2.0/node_modules/react-intl/lib/components/useIntl.js"),volto_form_block_actions__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("../../../node_modules/.pnpm/volto-form-block@3.17.0_@plone+volto@18.26.0_@babel+runtime@7.27.6_@popperjs+core@2.11.8_@typ_jqe57ctupqxsd6ko7tw7tsrcsm/node_modules/volto-form-block/src/actions/index.js"),volto_form_block_components_utils__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("../../../node_modules/.pnpm/volto-form-block@3.17.0_@plone+volto@18.26.0_@babel+runtime@7.27.6_@popperjs+core@2.11.8_@typ_jqe57ctupqxsd6ko7tw7tsrcsm/node_modules/volto-form-block/src/components/utils.js"),volto_form_block_components_FormView__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("../../../node_modules/.pnpm/volto-form-block@3.17.0_@plone+volto@18.26.0_@babel+runtime@7.27.6_@popperjs+core@2.11.8_@typ_jqe57ctupqxsd6ko7tw7tsrcsm/node_modules/volto-form-block/src/components/FormView.jsx"),_plone_volto_helpers_Utils_Date__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./src/helpers/Utils/Date.js"),_plone_volto_registry__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("./src/registry.js"),volto_form_block_components_Widget__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("../../../node_modules/.pnpm/volto-form-block@3.17.0_@plone+volto@18.26.0_@babel+runtime@7.27.6_@popperjs+core@2.11.8_@typ_jqe57ctupqxsd6ko7tw7tsrcsm/node_modules/volto-form-block/src/components/Widget/index.js"),volto_form_block_helpers_validators__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__("../../../node_modules/.pnpm/volto-form-block@3.17.0_@plone+volto@18.26.0_@babel+runtime@7.27.6_@popperjs+core@2.11.8_@typ_jqe57ctupqxsd6ko7tw7tsrcsm/node_modules/volto-form-block/src/helpers/validators.js"),volto_form_block_components_ValidateConfigForm__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__("../../../node_modules/.pnpm/volto-form-block@3.17.0_@plone+volto@18.26.0_@babel+runtime@7.27.6_@popperjs+core@2.11.8_@typ_jqe57ctupqxsd6ko7tw7tsrcsm/node_modules/volto-form-block/src/components/ValidateConfigForm.jsx"),__jsx=react__WEBPACK_IMPORTED_MODULE_0__.createElement;const messages=(0,react_intl__WEBPACK_IMPORTED_MODULE_10__.defineMessages)({formSubmitted:{id:"formSubmitted",defaultMessage:"Form successfully submitted"},defaultInvalidFieldMessage:{id:"formblock_defaultInvalidFieldMessage",defaultMessage:"Invalid field value"},requiredFieldMessage:{id:"formblock_requiredFieldMessage",defaultMessage:"Fill-in this field"},invalidEmailMessage:{id:"formblock_invalidEmailMessage",defaultMessage:"The email is incorrect"}}),initialState={loading:!1,error:null,result:null},FORM_STATES_normal="normal",FORM_STATES_loading="loading",FORM_STATES_error="error",FORM_STATES_success="success",formStateReducer=(state,action)=>{switch(action.type){case FORM_STATES_normal:return initialState;case FORM_STATES_loading:return{loading:!0,error:null,result:null};case FORM_STATES_error:return{loading:!1,error:action.error,result:null};case FORM_STATES_success:return{loading:!1,error:null,result:action.result};default:return initialState}},getInitialData=data=>{const{static_fields:static_fields=[],subblocks:subblocks=[]}=data;return(0,_home_runner_work_volto_site_componentes_volto_site_componentes_node_modules_pnpm_babel_runtime_7_26_10_node_modules_babel_runtime_helpers_esm_objectSpread2_js__WEBPACK_IMPORTED_MODULE_11__.c)((0,_home_runner_work_volto_site_componentes_volto_site_componentes_node_modules_pnpm_babel_runtime_7_26_10_node_modules_babel_runtime_helpers_esm_objectSpread2_js__WEBPACK_IMPORTED_MODULE_11__.c)({},subblocks.reduce(((acc,field)=>"hidden"===field.field_type?(0,_home_runner_work_volto_site_componentes_volto_site_componentes_node_modules_pnpm_babel_runtime_7_26_10_node_modules_babel_runtime_helpers_esm_objectSpread2_js__WEBPACK_IMPORTED_MODULE_11__.c)((0,_home_runner_work_volto_site_componentes_volto_site_componentes_node_modules_pnpm_babel_runtime_7_26_10_node_modules_babel_runtime_helpers_esm_objectSpread2_js__WEBPACK_IMPORTED_MODULE_11__.c)({},acc),{},{[(0,volto_form_block_components_utils__WEBPACK_IMPORTED_MODULE_3__.O)(field.label,field.id)]:(0,_home_runner_work_volto_site_componentes_volto_site_componentes_node_modules_pnpm_babel_runtime_7_26_10_node_modules_babel_runtime_helpers_esm_objectSpread2_js__WEBPACK_IMPORTED_MODULE_11__.c)((0,_home_runner_work_volto_site_componentes_volto_site_componentes_node_modules_pnpm_babel_runtime_7_26_10_node_modules_babel_runtime_helpers_esm_objectSpread2_js__WEBPACK_IMPORTED_MODULE_11__.c)({},field),data[field.id]&&{custom_field_id:data[field.id]})}):acc),{})),static_fields.reduce(((acc,field)=>(0,_home_runner_work_volto_site_componentes_volto_site_componentes_node_modules_pnpm_babel_runtime_7_26_10_node_modules_babel_runtime_helpers_esm_objectSpread2_js__WEBPACK_IMPORTED_MODULE_11__.c)((0,_home_runner_work_volto_site_componentes_volto_site_componentes_node_modules_pnpm_babel_runtime_7_26_10_node_modules_babel_runtime_helpers_esm_objectSpread2_js__WEBPACK_IMPORTED_MODULE_11__.c)({},acc),{},{[(0,volto_form_block_components_utils__WEBPACK_IMPORTED_MODULE_3__.O)(field.label,field.id)]:field})),{}))},View=({data:data,id:id,path:path})=>{const intl=(0,react_intl__WEBPACK_IMPORTED_MODULE_12__.c)(),dispatch=(0,react_redux__WEBPACK_IMPORTED_MODULE_1__.useDispatch)(),{0:formData,1:setFormData}=(0,react__WEBPACK_IMPORTED_MODULE_0__.useReducer)(((state,action)=>action.reset?getInitialData(data):(0,_home_runner_work_volto_site_componentes_volto_site_componentes_node_modules_pnpm_babel_runtime_7_26_10_node_modules_babel_runtime_helpers_esm_objectSpread2_js__WEBPACK_IMPORTED_MODULE_11__.c)((0,_home_runner_work_volto_site_componentes_volto_site_componentes_node_modules_pnpm_babel_runtime_7_26_10_node_modules_babel_runtime_helpers_esm_objectSpread2_js__WEBPACK_IMPORTED_MODULE_11__.c)({},state),{},{[action.field]:action.value})),getInitialData(data)),{0:formState,1:setFormState}=(0,react__WEBPACK_IMPORTED_MODULE_0__.useReducer)(formStateReducer,initialState),{0:formErrors,1:setFormErrors}=(0,react__WEBPACK_IMPORTED_MODULE_0__.useState)([]),submitResults=(0,react_redux__WEBPACK_IMPORTED_MODULE_1__.useSelector)((state=>{var _state$submitForm,_state$submitForm$sub;return null===(_state$submitForm=state.submitForm)||void 0===_state$submitForm||null===(_state$submitForm$sub=_state$submitForm.subrequests)||void 0===_state$submitForm$sub?void 0:_state$submitForm$sub[id]})),captchaToken=(0,react__WEBPACK_IMPORTED_MODULE_0__.useRef)(),onChangeFormData=(field_id,field,value,extras)=>{setFormData({field:field,value:(0,_home_runner_work_volto_site_componentes_volto_site_componentes_node_modules_pnpm_babel_runtime_7_26_10_node_modules_babel_runtime_helpers_esm_objectSpread2_js__WEBPACK_IMPORTED_MODULE_11__.c)({field_id:field_id,value:value},extras)})};(0,react__WEBPACK_IMPORTED_MODULE_0__.useEffect)((()=>{formErrors.length>0&&isValidForm()}),[formData]);const isValidForm=()=>{const v=[];return data.subblocks.forEach(((subblock,index)=>{var _config$blocks$blocks,_config$blocks$blocks2,_config$blocks$blocks3,_formData$name,_formData$name2,_formData$name2$value,_formData$name$value,_formData$name3,_formData$name4;const name=(0,volto_form_block_components_utils__WEBPACK_IMPORTED_MODULE_3__.O)(subblock.label,subblock.id),fieldType=subblock.field_type,additionalField=null!==(_config$blocks$blocks=null===(_config$blocks$blocks2=_plone_volto_registry__WEBPACK_IMPORTED_MODULE_6__.default.blocks.blocksConfig.form.additionalFields)||void 0===_config$blocks$blocks2||null===(_config$blocks$blocks3=_config$blocks$blocks2.filter((f=>f.id===fieldType&&void 0!==f.isValid)))||void 0===_config$blocks$blocks3?void 0:_config$blocks$blocks3[0])&&void 0!==_config$blocks$blocks?_config$blocks$blocks:null;if(!subblock.required||!additionalField||null!=additionalField&&additionalField.isValid(formData,name))(!subblock.required||"checkbox"!==fieldType||null!==(_formData$name=formData[name])&&void 0!==_formData$name&&_formData$name.value)&&(!subblock.required||formData[name]&&0!==(null===(_formData$name2=formData[name])||void 0===_formData$name2||null===(_formData$name2$value=_formData$name2.value)||void 0===_formData$name2$value?void 0:_formData$name2$value.length)&&"{}"!==JSON.stringify(null!==(_formData$name$value=null===(_formData$name3=formData[name])||void 0===_formData$name3?void 0:_formData$name3.value)&&void 0!==_formData$name$value?_formData$name$value:{}))?"from"===fieldType&&null!==(_formData$name4=formData[name])&&void 0!==_formData$name4&&_formData$name4.value&&!(0,volto_form_block_helpers_validators__WEBPACK_IMPORTED_MODULE_8__.sB)(formData[name].value)&&v.push({field:name,message:intl.formatMessage(messages.invalidEmailMessage)}):v.push({field:name,message:intl.formatMessage(messages.requiredFieldMessage)});else{const validation=null==additionalField?void 0:additionalField.isValid(formData,name);"boolean"==typeof validation?v.push({field:name,message:intl.formatMessage(messages.defaultInvalidFieldMessage)}):"object"==typeof validation&&v.push(validation)}})),data.captcha&&!captchaToken.current&&v.push({field:"captcha",message:intl.formatMessage(messages.requiredFieldMessage)}),setFormErrors(v),0===v.length},resetFormState=()=>{setFormData({reset:!0}),setFormState({type:FORM_STATES_normal})},getErrorMessage=field=>{const e=null==formErrors?void 0:formErrors.filter((e=>e.field===field));return e.length>0?e[0].message:null},captcha=new volto_form_block_components_Widget__WEBPACK_IMPORTED_MODULE_7__.Gw({captchaToken:captchaToken,captcha:data.captcha,captcha_props:data.captcha_props,errorMessage:getErrorMessage("captcha"),onChangeFormData:onChangeFormData}),formid=`form-${id}`;return(0,react__WEBPACK_IMPORTED_MODULE_0__.useEffect)((()=>{if(null!=submitResults&&submitResults.loaded){setFormState({type:FORM_STATES_success,result:intl.formatMessage(messages.formSubmitted)}),captcha.reset();const formItem=document.getElementById(formid);if(null!==formItem){const formItemPosition=formItem.getBoundingClientRect();null!==formItemPosition&&window.scrollTo({top:formItemPosition.x,left:formItemPosition.y,behavior:"smooth"})}}else if(null!=submitResults&&submitResults.error){var _JSON$parse,_submitResults$error$,_submitResults$error$2;let errorDescription=`${null===(_JSON$parse=JSON.parse(null!==(_submitResults$error$=null===(_submitResults$error$2=submitResults.error.response)||void 0===_submitResults$error$2?void 0:_submitResults$error$2.text)&&void 0!==_submitResults$error$?_submitResults$error$:"{}"))||void 0===_JSON$parse?void 0:_JSON$parse.message}`;setFormState({type:FORM_STATES_error,error:errorDescription})}}),[submitResults]),(0,react__WEBPACK_IMPORTED_MODULE_0__.useEffect)((()=>{resetFormState()}),[]),__jsx(volto_form_block_components_ValidateConfigForm__WEBPACK_IMPORTED_MODULE_9__.c,{data:data},__jsx(volto_form_block_components_FormView__WEBPACK_IMPORTED_MODULE_4__.default,{id:formid,formState:formState,formErrors:formErrors,formData:formData,captcha:captcha,onChangeFormData:onChangeFormData,data:data,onSubmit:e=>{e.preventDefault(),captcha.verify().then((()=>{if(isValidForm()){let attachments={},captcha={provider:data.captcha,token:captchaToken.current};var _formData$data$captch,_formData$data$captch2;if("honeypot"===data.captcha)captcha.value=null!==(_formData$data$captch=null===(_formData$data$captch2=formData[data.captcha_props.id])||void 0===_formData$data$captch2?void 0:_formData$data$captch2.value)&&void 0!==_formData$data$captch?_formData$data$captch:"";let formattedFormData=(0,_home_runner_work_volto_site_componentes_volto_site_componentes_node_modules_pnpm_babel_runtime_7_26_10_node_modules_babel_runtime_helpers_esm_objectSpread2_js__WEBPACK_IMPORTED_MODULE_11__.c)({},formData);if(data.subblocks.forEach((subblock=>{var _formattedFormData$na;let name=(0,volto_form_block_components_utils__WEBPACK_IMPORTED_MODULE_3__.O)(subblock.label,subblock.id);if(null!==(_formattedFormData$na=formattedFormData[name])&&void 0!==_formattedFormData$na&&_formattedFormData$na.value){formattedFormData[name].field_id=subblock.field_id;const isAttachment=_plone_volto_registry__WEBPACK_IMPORTED_MODULE_6__.default.blocks.blocksConfig.form.attachment_fields.includes(subblock.field_type),isDate="date"===subblock.field_type;isAttachment&&(attachments[name]=formattedFormData[name].value,delete formattedFormData[name]),isDate&&(formattedFormData[name].value=(0,_plone_volto_helpers_Utils_Date__WEBPACK_IMPORTED_MODULE_5__._m)({date:formattedFormData[name].value,format:"DD-MM-YYYY",locale:intl.locale}))}})),attachments&&"object"==typeof attachments){const flattenedAttachments={};Object.entries(attachments).forEach((([fieldName,value])=>{Array.isArray(value)?value.forEach(((file,index)=>{flattenedAttachments[`${fieldName}_${index}`]={data:file.data,encoding:file.encoding,"content-type":file["content-type"],filename:file.filename,size:file.size}})):flattenedAttachments[fieldName]=value})),attachments=flattenedAttachments}dispatch((0,volto_form_block_actions__WEBPACK_IMPORTED_MODULE_2__.QB)(path,id,Object.keys(formattedFormData).map((name=>(0,_home_runner_work_volto_site_componentes_volto_site_componentes_node_modules_pnpm_babel_runtime_7_26_10_node_modules_babel_runtime_helpers_esm_objectSpread2_js__WEBPACK_IMPORTED_MODULE_11__.c)({},formattedFormData[name]))),attachments,captcha)),setFormState({type:FORM_STATES_loading})}else setFormState({type:FORM_STATES_error})})).catch((()=>{setFormState({type:FORM_STATES_error})}))},resetFormState:resetFormState,resetFormOnError:()=>{setFormState({type:FORM_STATES_normal})},getErrorMessage:getErrorMessage}))};__webpack_exports__.default=View,View.__docgenInfo={description:"Form view\n@class View",methods:[],displayName:"View",props:{data:{description:"",type:{name:"objectOf",value:{name:"any"}},required:!0}}}}}]);